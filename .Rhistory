ggplot(aes(x = year, y = count, fill = incident_type)) +
geom_bar(position = "dodge", stat="identity") +
# Labels
labs(title = "Top 3 Incidents by Year") +
labs(subtitle = "2015 - 2020") +
xlab("Year") +
ylab("Count") +
labs(fill = "Incident Type") +
annotate("segment",
y = 636, yend = 636,
x = 2017,xend = 2019,
alpha = 0.4, size = 1, linetype=2) +
annotate("text", label = "Equal number of incidents.",
y = 1200, x = 2019) +
annotate("curve",
y = 1140, yend = 680,
x = 2019, xend = 2018,
curvature = 0.3,
arrow = arrow(length = unit(2, "mm")))
responses %>%
filter(year(offense_date) > 2014) %>%
group_by(year = year(offense_date), incident_type) %>%
summarise(count = n()) %>%
group_by(year) %>%
top_n(n = 3, wt = count) %>%
ggplot(aes(x = year, y = count, fill = incident_type)) +
geom_bar(position = "dodge", stat="identity") +
# Labels
labs(title = "Top 3 Incidents by Year") +
labs(subtitle = "2015 - 2020") +
xlab("Year") +
ylab("Count") +
labs(fill = "Incident Type") +
annotate("segment",
y = 636, yend = 636,
x = 2017.5,xend = 2019,
alpha = 0.4, size = 1, linetype=2) +
annotate("text", label = "Equal number of incidents.",
y = 1200, x = 2019) +
annotate("curve",
y = 1140, yend = 680,
x = 2019, xend = 2018,
curvature = 0.3,
arrow = arrow(length = unit(2, "mm")))
responses %>%
filter(year(offense_date) > 2014) %>%
group_by(year = year(offense_date), incident_type) %>%
summarise(count = n()) %>%
group_by(year) %>%
top_n(n = 3, wt = count) %>%
ggplot(aes(x = year, y = count, fill = incident_type)) +
geom_bar(position = "dodge", stat="identity") +
# Labels
labs(title = "Top 3 Incidents by Year") +
labs(subtitle = "2015 - 2020") +
xlab("Year") +
ylab("Count") +
labs(fill = "Incident Type") +
annotate("segment",
y = 636, yend = 636,
x = 2017.5,xend = 2018.5,
alpha = 0.4, size = 1, linetype=2) +
annotate("text", label = "Equal number of incidents.",
y = 1200, x = 2019) +
annotate("curve",
y = 1140, yend = 680,
x = 2019, xend = 2018,
curvature = 0.3,
arrow = arrow(length = unit(2, "mm")))
responses %>%
filter(year(offense_date) > 2014) %>%
group_by(year = year(offense_date), incident_type) %>%
summarise(count = n()) %>%
group_by(year) %>%
top_n(n = 3, wt = count) %>%
ggplot(aes(x = year, y = count, fill = incident_type)) +
geom_bar(position = "dodge", stat="identity") +
# Labels
labs(title = "Top 3 Incidents by Year") +
labs(subtitle = "2015 - 2020") +
xlab("Year") +
ylab("Count") +
labs(fill = "Incident Type") +
annotate("segment",
y = 636, yend = 636,
x = 2017.5,xend = 2018.5,
alpha = 0.4, size = 1, linetype=1) +
annotate("text", label = "Equal number of incidents.",
y = 1200, x = 2019) +
annotate("curve",
y = 1140, yend = 680,
x = 2019, xend = 2018,
curvature = 0.3,
arrow = arrow(length = unit(2, "mm")))
responses %>%
filter(year(offense_date) > 2014) %>%
group_by(year = year(offense_date), incident_type) %>%
summarise(count = n()) %>%
group_by(year) %>%
bottom_n(n = 3, wt = count) %>%
ggplot(aes(x = year, y = count, fill = incident_type)) +
geom_bar(position = "dodge", stat="identity")
?top_n
responses %>%
filter(year(offense_date) > 2014) %>%
group_by(year = year(offense_date), incident_type) %>%
summarise(count = n()) %>%
group_by(year) %>%
top_n(n = 3, wt = -count) %>%
ggplot(aes(x = year, y = count, fill = incident_type)) +
geom_bar(position = "dodge", stat="identity")
View(areas)
ggplot() +
geom_sf(data = areas)
ggplot(fl_counties, aes(lon, lat, group = group)) +
geom_polygon(fill = "white", color = "gray") +
coord_quickmap() +
geom_sf(data = areas)
ggplot(fl_counties, aes(lon, lat, group = group)) +
geom_polygon(fill = "white", color = "gray") +
coord_quickmap() +
geom_sf(data = areas)
responses %>% filter(year(offense_date) > 2014) %>%
group_by(date = date(offense_date)) %>%
summarise(offenses = n()) %>%
ggplot() +
geom_smooth(aes(x = date, y = offenses)) +
labs(title = "Offenses by Date") +
labs(subtitle = "2015 - Present") +
xlab("Year") +
ylab("Number of offenses")
responses %>%
filter(year(offense_date) > 2014) %>%
group_by(year = year(offense_date), incident_type) %>%
summarise(count = n()) %>%
group_by(year) %>%
top_n(n = 3, wt = count) %>%
ggplot(aes(x = year, y = count, fill = incident_type)) +
geom_bar(position = "dodge", stat="identity") +
# Labels
labs(title = "Top 3 Incidents by Year") +
labs(subtitle = "2015 - 2020") +
xlab("Year") +
ylab("Count") +
labs(fill = "Incident Type") +
annotate("segment",
y = 636, yend = 636,
x = 2017.5,xend = 2018.5,
alpha = 0.4, size = 1, linetype=1) +
annotate("text", label = "Equal number of incidents.",
y = 1200, x = 2019) +
annotate("curve",
y = 1140, yend = 680,
x = 2019, xend = 2018,
curvature = 0.3,
arrow = arrow(length = unit(2, "mm")))
ggplot() +
geom_sf(data = areas) +
geom_point(data = responses, aes(x = longitude, y = latitude))
ggplot() +
geom_sf(data = areas) +
geom_point(data = responses, aes(x = longitude, y = latitude))
ggplot() +
geom_sf(data = areas) +
geom_point(data = responses, aes(y = longitude, x = latitude))
ggplot() +
geom_sf(data = areas)
source('~/Documents/gainsville_exercise/cleaning_script.r', echo=TRUE)
st_as_sfc(responses$location)
View(areas)
str(areas)
ggplot() +
geom_sf()
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_point(data = responses, aes(y = longitude, x = latitude))
ggplot() +
geom_sf() +
geom_sf(data = areas)
read_sf("data/Crime_Responses.csv")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/gainsville_exercise")
library(tidyverse); theme_set(theme_minimal())
library(knitr)
library(patchwork)
library(janitor)
library(maps)
library(sf)
source('cleaning_script.r')
head(responses)
summary(responses)
responses %>% filter(year(offense_date) > 2014) %>%
group_by(date = date(offense_date)) %>%
summarise(offenses = n()) %>%
ggplot() +
geom_smooth(aes(x = date, y = offenses)) +
labs(title = "Offenses by Date") +
labs(subtitle = "2015 - Present") +
xlab("Year") +
ylab("Number of offenses")
ggplot() +
geom_sf() +
geom_sf(data = areas)
geom_point(data = responses, aes(y = longitude, x = latitude))
responses %>%
filter(year(offense_date) > 2014) %>%
group_by(year = year(offense_date), incident_type) %>%
summarise(count = n()) %>%
group_by(year) %>%
top_n(n = 3, wt = count) %>%
ggplot(aes(x = year, y = count, fill = incident_type)) +
geom_bar(position = "dodge", stat="identity") +
# Labels
labs(title = "Top 3 Incidents by Year") +
labs(subtitle = "2015 - 2020") +
xlab("Year") +
ylab("Count") +
labs(fill = "Incident Type") +
annotate("segment",
y = 636, yend = 636,
x = 2017.5,xend = 2018.5,
alpha = 0.4, size = 1, linetype=1) +
annotate("text", label = "Equal number of incidents.",
y = 1200, x = 2019) +
annotate("curve",
y = 1140, yend = 680,
x = 2019, xend = 2018,
curvature = 0.3,
arrow = arrow(length = unit(2, "mm")))
geom_point(data = responses)
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_point(data = responses)
ggplot() +
geom_sf() +
geom_point(data = responses)
View(responses)
str(responses)
responses$latitude <- as.numeric(responses$latitude)
# Coordinates
responses$longitude <- as.numeric(responses$longitude)
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_sf(data = responses)
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_point(data = responses, aes(x = longitude, y = latitude))
ggplot() +
geom_sf() +
geom_sf(data = areas)
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_point(data = responses, aes(x = longitude, y = latitude)) +
ylim(30) + xlim(83)
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_point(data = responses, aes(x = longitude, y = latitude))
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_point(data = responses, aes(x = longitude, y = latitude)) +
ylim(c(40,20))
ggplot() +
geom_sf() +
geom_sf(data = areas)
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_point(data = responses, aes(x = longitude, y = latitude)) +
ylim(c(28,31)) + xlim(c(81, 83))
ggplot() +
geom_sf() +
geom_sf(data = areas) +
ylim(c(28,31)) + xlim(c(81, 83))
ggplot() +
geom_sf() +
geom_sf(data = areas)
st_as_sf(responses, coords = c("longitude", "latitude"))
st_as_sf(responses, coords = c("longitude", "latitude")) -> responses
ggplot() +
geom_sf() +
geom_sf(data = responses)
View(areas)
View(responses)
ggplot() +
geom_sf() +
geom_sf(data = responses)
ggplot() +
geom_sf() +
geom_sf(data = areas)
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_sf(data = responses)
?geom_sf
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_sf(data = head(responses,4))
ggplot() +
geom_sf() +
geom_sf(data = head(responses,4))
ggplot() +
geom_sf(data = head(responses,4)) +
geom_sf(area())
ggplot() +
geom_sf(data = head(responses,4)) +
geom_sf(areas)
ggplot() +
geom_sf(data = head(responses,4))
plot(areas)
plot(responses)
st_intersects(areas$geometry, responses$geometry)
str(areas)
st_crs(areas)
st_crs(responses)
st_set_crs(responses, 4326)
st_crs(responses)
st_set_crs(responses, 4326) -> responses
st_crs(responses)
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_sf(data = head(responses,4))
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_sf(data = head(responses,40))
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_sf(data = responses)
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_sf(data = head(responses,20))
ggplot() +
geom_sf() +
geom_sf(data = areas) +
geom_sf(data = responses)
ggplot() +
geom_sf() +
geom_sf(data = areas)
geom_sf(data = responses, xlim(c(81,83)), ylim(c(28, 39)))
geom_sf(data = responses, aes(xlim(c(81,83)), ylim(c(28, 39))) )
ggplot() +
geom_sf() +
geom_sf(data = areas)
geom_sf(data = responses, aes(xlim(c(81,83)), ylim(c(28, 39))) )
ggplot() +
geom_sf(data = areas)
geom_sf(data = responses)
ggplot() +
geom_sf(data = areas) +
geom_sf(data = responses)
ggplot() +
geom_sf(data = areas) +
geom_sf(data = head(responses,40))
sf::st_intersection(areas, responses)
sf::st_intersection(areas, responses)
sf::st_intersection(areas, responses)
sf::st_intersection(areas$geometry, responses$geometry)
st_contains(responses, areas)
st_contains(areas, responses)
st_intersection(st_simplify(responses), areas)
sf::st_intersects(responses, areas)
sf::st_intersects(responses, areas) %>% cbind(responses)
sf::st_intersects(responses, areas) %>% View()
sf::st_intersects(responses, areas) -> intersections
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/gainsville_exercise")
library(tidyverse); theme_set(theme_minimal())
library(knitr)
library(patchwork)
library(janitor)
library(maps)
library(sf)
source('cleaning_script.r')
head(responses)
summary(responses)
responses %>% filter(year(offense_date) > 2014) %>%
group_by(date = date(offense_date)) %>%
summarise(offenses = n()) %>%
ggplot() +
geom_smooth(aes(x = date, y = offenses)) +
labs(title = "Offenses by Date") +
labs(subtitle = "2015 - Present") +
xlab("Year") +
ylab("Number of offenses")
ggplot() +
geom_sf(data = areas) +
geom_sf(data = head(responses,40))
responses %>%
filter(year(offense_date) > 2014) %>%
group_by(year = year(offense_date), incident_type) %>%
summarise(count = n()) %>%
group_by(year) %>%
top_n(n = 3, wt = count) %>%
ggplot(aes(x = year, y = count, fill = incident_type)) +
geom_bar(position = "dodge", stat="identity") +
# Labels
labs(title = "Top 3 Incidents by Year") +
labs(subtitle = "2015 - 2020") +
xlab("Year") +
ylab("Count") +
labs(fill = "Incident Type") +
annotate("segment",
y = 636, yend = 636,
x = 2017.5,xend = 2018.5,
alpha = 0.4, size = 1, linetype=1) +
annotate("text", label = "Equal number of incidents.",
y = 1200, x = 2019) +
annotate("curve",
y = 1140, yend = 680,
x = 2019, xend = 2018,
curvature = 0.3,
arrow = arrow(length = unit(2, "mm")))
sf::st_intersects(responses, areas) -> intersections
responses$area <- as.character(areas[unlist[intersections]])
responses$area <- as.character(areas$label[unlist[intersections]])
responses$area <- as.character(areas$label[unlist(intersections)])
sf::st_intersects(responses, areas) %>% as.integer() -> intersections
sf::st_intersects(responses, areas)  -> intersections
responses$area <- as.character(areas$label[unlist(intersections)])
source('~/Documents/gainsville_exercise/cleaning_script.r', echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/gainsville_exercise")
library(tidyverse); theme_set(theme_minimal())
library(knitr)
library(patchwork)
library(janitor)
library(maps)
library(sf)
sf::st_intersects(responses, areas)  -> intersections
responses$area <- as.character(areas$label[unlist(intersections)])
View(responses)
source('~/Documents/gainsville_exercise/cleaning_script.r', echo=TRUE)
#cat("Removing location. Extraneous variable. \n")
responses$location <- st_as_sfc(responses$location)
View(areas)
View(responses)
#cat("Removing location. Extraneous variable. \n")
responses$location <- st_as_sfc(responses$location) %>% st_sf(ID = paste-("point"))
#cat("Removing location. Extraneous variable. \n")
responses$location <- st_as_sfc(responses$location) %>% st_sf(ID = paste-("point", 1:164070))
#cat("Removing location. Extraneous variable. \n")
responses$location <- st_as_sfc(responses$location) %>% st_sf(ID = paste0("point" ,1:164070))
View(responses)
#cat("Removing location. Extraneous variable. \n")
responses$location <- st_as_sf(responses$location) %>% st_sf(ID = paste0("point", 1:164070))
#cat("Removing location. Extraneous variable. \n")
responses$location <- st_as_sfc(responses$location) %>% st_sf(ID = paste0("point", 1:164070))
#cat("Removing location. Extraneous variable. \n")
responses$location <- st_as_sfc(responses$location)
responses$location %>% st_point()
responses$location %>% st_as_sfc()
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/gainsville_exercise")
library(tidyverse); theme_set(theme_minimal())
library(knitr)
library(patchwork)
library(janitor)
library(maps)
library(sf)
source('cleaning_script.r')
head(responses)
summary(responses)
responses %>% filter(year(offense_date) > 2014) %>%
group_by(date = date(offense_date)) %>%
summarise(offenses = n()) %>%
ggplot() +
geom_smooth(aes(x = date, y = offenses)) +
labs(title = "Offenses by Date") +
labs(subtitle = "2015 - Present") +
xlab("Year") +
ylab("Number of offenses")
ggplot() +
geom_sf(data = areas) +
geom_sf(data = head(responses,40))
responses %>%
filter(year(offense_date) > 2014) %>%
group_by(year = year(offense_date), incident_type) %>%
summarise(count = n()) %>%
group_by(year) %>%
top_n(n = 3, wt = count) %>%
ggplot(aes(x = year, y = count, fill = incident_type)) +
geom_bar(position = "dodge", stat="identity") +
# Labels
labs(title = "Top 3 Incidents by Year") +
labs(subtitle = "2015 - 2020") +
xlab("Year") +
ylab("Count") +
labs(fill = "Incident Type") +
annotate("segment",
y = 636, yend = 636,
x = 2017.5,xend = 2018.5,
alpha = 0.4, size = 1, linetype=1) +
annotate("text", label = "Equal number of incidents.",
y = 1200, x = 2019) +
annotate("curve",
y = 1140, yend = 680,
x = 2019, xend = 2018,
curvature = 0.3,
arrow = arrow(length = unit(2, "mm")))
source('~/Documents/gainsville_exercise/cleaning_script.r', echo=TRUE)
source('~/Documents/gainsville_exercise/cleaning_script.r', echo=TRUE)
