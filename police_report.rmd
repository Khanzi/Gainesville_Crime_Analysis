---
title: "City Of Gainseville"
author: "Kahlil Wehmeyer - Office of Strategic Initiatives"
date: "11/4/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/gainsville_exercise")
library(tidyverse); theme_set(theme_minimal())
library(knitr)
library(patchwork)
library(janitor)
library(maps)
library(sf)
```

# Introduction

# Data
The data for this exploration is based on the public _"Crime Responses"_ data set which is available [here](https://data.cityofgainesville.org/Public-Safety/Crime-Responses/gvua-xt9q). The version used in this report was last updated on November 3rd, 2020.

Additional information about districts is available [here](https://data.cityofgainesville.org/Geospatial-Maps-/Color-Coded-Gainesville-Police-Zones/qzci-z4wx)

**Note**:

Data is being prepared by an external script.

- Correcting date types
- Better variable naming
- Removing extraneous variables


```{r importing data, echo=FALSE, include=FALSE}
source('cleaning_script.r')
```

```{r initial look}
head(responses) 
summary(responses) 
```

# Initial Visualizations



```{r}
responses %>% filter(year(offense_date) > 2014) %>% 
  group_by(date = date(offense_date)) %>% 
  summarise(offenses = n()) %>% 
  
  ggplot() + 
  geom_smooth(aes(x = date, y = offenses)) +
  
  labs(title = "Offenses by Date") +
  labs(subtitle = "2015 - Present") +
  xlab("Year") +
  ylab("Number of offenses")
```

```{r}
ggplot() +
  geom_sf(data = areas) +
  geom_sf(data = head(responses,40)) 

```


```{r}
responses %>% 
  filter(year(offense_date) > 2014) %>% 
  group_by(year = year(offense_date), incident_type) %>% 
  summarise(count = n()) %>% 
  group_by(year) %>% 
  top_n(n = 3, wt = count) %>% 
  
  ggplot(aes(x = year, y = count, fill = incident_type)) +
  geom_bar(position = "dodge", stat="identity") +
  
  # Labels
  labs(title = "Top 3 Incidents by Year") + 
  labs(subtitle = "2015 - 2020") +
  xlab("Year") + 
  ylab("Count") +
  labs(fill = "Incident Type") +
  
  annotate("segment",
           y = 636, yend = 636,
           x = 2017.5,xend = 2018.5,
           alpha = 0.4, size = 1, linetype=1) +

  annotate("text", label = "Equal number of incidents.",
           y = 1200, x = 2019) +
  
  annotate("curve",
           y = 1140, yend = 680,
           x = 2019, xend = 2018,
           curvature = 0.3,
           arrow = arrow(length = unit(2, "mm")))
  
  
```
```{r}
```

